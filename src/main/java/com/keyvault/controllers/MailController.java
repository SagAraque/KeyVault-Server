package com.keyvault.controllers;

import javax.mail.*;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.InternetAddress;
import java.io.UnsupportedEncodingException;
import java.util.Properties;

public class MailController extends Thread{
    private String email, authCode;
    public MailController(String authCode, String email)
    {
        this.authCode = authCode;
        this.email = email;
    }

    @Override
    public void run()
    {
        try {
            sendAuthMail();
        } catch (UnsupportedEncodingException | MessagingException e) {
            throw new RuntimeException(e);
        }
    }

    private void sendAuthMail() throws UnsupportedEncodingException, MessagingException {
        Properties prop = new Properties();
        prop.put("mail.smtp.host", "213.37.28.35");
        //prop.put("mail.smtp.port", "587");
        prop.put("mail.smtp.socketFactory.port", "587");
        prop.put("mail.smtp.socketFactory.class", "javax.net.ssl.SSLSocketFactory");
        prop.put("mail.smtp.ssl.protocols", "TLSv1.2");
        prop.put("mail.smtp.socketFactory.fallback", "true");
        prop.put("mail.smtp.starttls.enable", "true");
        prop.put("mail.smtp.auth", "false");

        Session session = Session.getInstance(prop);

        MimeMessage msg = new MimeMessage(session);
        msg.setFrom(new InternetAddress("auth@sagaraque.com.es", "KeyVault"));
        msg.addRecipient(Message.RecipientType.TO, new InternetAddress(email));
        msg.setSubject("Código de verificación");
        msg.setContent(getEmailTemplate(), "text/html");

        Transport.send(msg);
    }

    private String getEmailTemplate()
    {
       return "<!DOCTYPE html>\n" +
               "<html>\n" +
               "<head>\n" +
               "    <meta charset=\"UTF-8\">\n" +
               "    <meta http-equiv=\"Content-Type\" content=\"text/html charset=UTF-8\" />\n" +
               "    <title>Código de verificación</title>\n" +
               "</head>\n" +
               "<body style=\"background-color: #e7e7e7; margin: 0; padding: 40px 0; font-family: Arial, sans-serif\">\n" +
               "<table style=\"width: 100%; max-width: 600px; margin: 40px auto; background-color: #ffffff; border-radius: 2px; border-top: 3px solid #2a333f;\">\n" +
               "    <tr>\n" +
               "        <td style=\"padding: 40px; box-sizing: border-box;\">\n" +
               "            <img style=\"margin-top: 20px; margin-bottom: 0; margin-right: 10px\" src=\"data:image/png;base64,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\" alt=\"KeyVault Logo\">" +
               "            <h1 style=\"color: black; font-size: 25px; text-align: center;\">Verificación de dispositivo</h1>\n" +
               "            <p style=\"color: black; margin-bottom: 0; text-align: center;\">Se detectó un nuevo inicio de sesión en un dispositivo no autorizado.</p>\n" +
               "            <p style=\"color: black; margin-bottom: 20px; text-align: center;\">Copie el siguiente código de verificación:</p>\n" +
               "            <p style=\"font-size: 25px; margin-bottom: 20px; font-weight: bold; text-align: center;\">"+ authCode  +"</p>\n" +
               "        </td>\n" +
               "    </tr>\n" +
               "</table>\n" +
               "</body>\n" +
               "</html>";
    }
}
